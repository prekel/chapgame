\chapter{Теоретическая часть}

\section{Описание модели}

\textbf{Тело}. Aбсолютно твёдрое тело в форме круга равномерной плотности
(центр масс в центре круга) обладающее массой (\(m\)), коэффициентом трения (\(\mu\)),
радиусом (\(r\)), начальной скоростью (\(\vec{v_0}\)), положением (координаты \(x\) и \(y\) или радиус-вектор \(\vec{r}\)).
На тело действует сила трения (\(F_\text{тр.}\)). \TODO

\textbf{Точка}. Неподвижная точка в пространстве, определена через координаты.

\textbf{Линия}. Неподвижная прямая линия в пространстве, может быть ограничена точкой с двух или
одной сторон образуя отрезок или луч соответсвенно. Определена через общее уравнение прямой.

\textbf{Сцена}. Множество тел, линий, точек и постоянных (например, ускорение свободного падения).

Обновлённая сцена~-- сцена, в которой обновлены параметры тел, линий, точек или постоянных.

Сцена через время \(\Delta t\)~-- обновлённая сцена, в которой все тела обновлены так,
что новая начальная скорость равна скорости в этот момент времени (\ref{v_new_old}).

\begin{equation}\label{v_new_old}
  \vec{{v_0}_\text{new}} = \vec{v}(\Delta t)
\end{equation}

\begin{Underequation}
  \(\vec{{v_0}_\text{new}}\)~-- новая начальная скорость;

  \(\vec{v}(\Delta t)\)~-- старая скорость в момент времени \(\Delta t\).
\end{Underequation}

\textbf{Модель}. Множество пар \((t, S)\), где \(t\)~-- момент времени, а \(S\)~-- сцена.
Иными словами, модель представляет собой цепочку сцен, для каждой из которой указан момент времени.

Сцена в момент времени \(t_1\)~-- такая сцена \(S_0\) через время \(t_1 - t_0\),
где пара \((t_0, S_0)\) является членом модели, при этом соблюдается (\ref{forall_1}).

\begin{equation}\label{forall_1}
  \forall (t, S) \in M~~(t \leqslant  t_0 \vee t > t_1)
\end{equation}

\begin{Underequation}
  \(M\)~-- модель;

  \(t_0\)~-- время, выбранное для получения модели в момент времени \(t_1\);
\end{Underequation}

Иными словами, для того чтобы получить сцену в момент времени, надо из цепочки сцен найти такую,
у которой время будет максимально, но при этом меньше требуемого момента времени и получить
сцену через разность требуемого и найденого времени по формуле (\ref{v_new_old}).

\textbf{Столкновение}. Так как тела не могут пересекаться, и при этом передвигаются, могут происходить столкновения.
Так же тела не могут пересекаться с точками и линиями. Т.е. тела могут сталкиваться с телами, или линиями, или точками.
Уравнение столкновения тела с телом (\ref{bodybodycollision})-через радиус-вектор, (\ref{bodybodycollisioncoords})-через координаты.

\begin{equation}\label{bodybodycollision}
  \left|\vec{r_1}(t) - \vec{r_2}(t)\right| = r_1 + r_2
\end{equation}

\begin{Underequation}
  \(\vec{r_1}(t)\)~-- радиус-вектор положения первого тела;

  \(\vec{r_2}(t)\)~-- радиус-вектор положения второго тела;

  \(r_1\)~-- радиус первого тела;

  \(r_2\)~-- радиус второго тела.
\end{Underequation}

\begin{equation}\label{bodybodycollisioncoords}
  \sqrt{(x_1(t) - x_2(t))^2 + (y_1(t) - y_2(t))^2} = r_1 + r_2
\end{equation}

\begin{Underequation}
  \(x_1(t)\)~-- координата положения первого тела по оси \(X\);

  \(y_1(t)\)~-- координата положения первого тела по оси \(Y\);

  \(x_2(t)\)~-- координата положения второго тела по оси \(X\);

  \(y_2(t)\)~-- координата положения второго тела по оси \(Y\).
\end{Underequation}

Эти уравнения получены исходя из того что разность векторов является вектором из центра одного тела в центр другого \cite[с. 39]{mathforprogrammers}.
И тогда, если его длина равна сумме радиусов этих тел, значит тела столкнулись.

Подобным образом можно определить уравнение столкновения тела с точкой:
(\ref{bodypointcollision})-через радиус-вектор, (\ref{bodypointcollisioncoords})-через координаты.

\begin{equation}\label{bodypointcollision}
  \left|\vec{r}(t) - \vec{p}\right| = r
\end{equation}
\begin{Underequation}
  \(\vec{r}(t)\)~-- радиус-вектор положения тела;

  \(\vec{p}\)~-- радиус-вектор точки;

  \(r\)~-- радиус тела.
\end{Underequation}

\begin{equation}\label{bodypointcollisioncoords}
  \sqrt{(x(t) - p_x)^2 + (y(t) - p_y)^2} = r
\end{equation}

\begin{Underequation}
  \(x(t)\)~-- координата положения тела по оси \(X\);

  \(y(t)\)~-- координата положения тела по оси \(Y\);

  \(p_x\)~-- координата точки по оси \(X\);

  \(p_y\)~-- координата точки по оси \(Y\).
\end{Underequation}

С обнаружение столкновением тела и линии ситуация несколько иная,
надо воспользоваться формулой расстояний от точки до прямой (\ref{distance_1}) \cite[с. 452]{larson}
и тогда получится (\ref{bodylinecolision}).

\begin{equation}\label{distance_1}
  \frac{\left|Ax + By + C\right|}{\sqrt{A^2 + B^2}}
\end{equation}

\begin{Underequation}
  \(A\),~\(B\),~\(C\)~-- коэффициенты общего уравнения прямой;

  \(x\),~\(y\)~-- координаты точки.
\end{Underequation}

\begin{equation}\label{bodylinecolision}
  \frac{\left|A x(t) + B y(t) + C\right|}{\sqrt{A^2 + B^2}} = r
\end{equation}

\begin{Underequation}
  \(x(t)\),~\(y(t)\)~-- координаты тела в момент времени \(t\).
\end{Underequation}

В дальнейшем будут определены формулы для нахождения положения тела, а именно: (\ref{r_x_1}), (\ref{r_y_1}).

\section{Определение формул скорости и траектории тела}

Далее, под моментом времени \(t\) будет подразумематься время относительно сцены, а не модели.

Как указано выше, у тела есть начальная скорость и на него действует сила трения.
По второму закону Ньютона \cite[с.~114]{rowellherbert}, у тела есть ускорение так как на него действует сила.
Такое движение называется равноускоренным.

Скорость при равноускоренном движении \cite[с.~96]{rowellherbert}: определяется формулой (\ref{velocityvec_1}).

\begin{equation}\label{velocityvec_1}
  \vec{v}(t) = \vec{v_0} + \vec{a}t
\end{equation}

\begin{Underequation}
  \(\vec{v}(t)\)~-- вектор скорости тела в момент времени \(t\);

  \(\vec{v_0}\)~-- вектор начальной скорости тела;

  \(\vec{a}\)~-- вектор ускорения тела;

  \(t\)~-- момент времени.
\end{Underequation}

При этом вектор ускорения сонаправлен вектору силы (по второму закону Ньютона, (\ref{newton_law_2})).

\begin{equation}\label{newton_law_2}
  \vec{a} = \frac{\vec{F}}{m}
\end{equation}

\begin{Underequation}
  \(\vec{a}\)~-- вектор ускорения тела;

  \(\vec{F}\)~-- вектор силы действующей на тело;

  \(m\)~-- масса тела.
\end{Underequation}

Но вектор силы трения \(\vec{F_{\text{тр.}}}\) противонаправлен вектору скорости тела [\TODO].
Поэтому, и вектор ускорения тела будет противонаправлен вектору скорости тела.

При этом вектор скорости тела \(\vec{v}(t)\) должен быть сонаправлен вектору \(\vec{v_0}\)
потому что тело не может поменять направление движения при воздействии силы трения.
Для того чтобы выяснить, при каких \(t\) сонаправленность векторов \(\vec{v}(t)\) и \(\vec{v_0}\)
в уравнении (\ref{velocityvec_1}) соблюдается,
достаточно увидеть, что длина вектора \(\vec{v_0}\) должна быть больше длине вектора \(\vec{a}t\)
и получить неравенство для \(t\) (\ref{constraint_t_1}).

% \[
%   \left|\vec{v_0}\right| > \left|\vec{a}t\right|
% \]
% \[
%   \left|\vec{v_0}\right| > \left|\vec{a}\right| t
% \]
% \[
%   \frac{\left|\vec{v_0}\right|}{\left|\vec{a}\right| } > t
% \]

\newcommand\Constrainttle{
  t < \frac{\left|\vec{v_0}\right|}{\left|\vec{a}\right|}
}

\newcommand\Constrainttge{
  t \geqslant \frac{\left|\vec{v_0}\right|}{\left|\vec{a}\right|}
}

\begin{equation}\label{constraint_t_1}
  \Constrainttle
\end{equation}

А для остальных \(t\), \(\vec{v}(t)\) следует принять нулю. Тогда скорость выражается через (\ref{v_system}):

\begin{equation}\label{v_system}
  \vec{v}(t) =
  \begin{cases}
    \vec{v_0} + \vec{a}t, & 0 \leqslant \Constrainttle, \\
    0,                    & \Constrainttge .
  \end{cases}
\end{equation}

Проекции на ось абцисс (\ref{v_x_1}) и ординат (\ref{v_y_1}):

\begin{equation}\label{v_x_1}
  v_x(t) =
  \begin{cases}
    {v_0}_x + a_x t, & 0 \leqslant \Constrainttle, \\
    0,               & \Constrainttge.
  \end{cases}
\end{equation}

\begin{Underequation}
  \(v_x(t)\)~-- проекция вектора скорости тела \(\vec{v}(t)\) в момент времени \(t\) на ось \(X\);

  \({v_0}_x\)~-- проекция вектора начальной скорости тела \(\vec{v_0}\) на ось \(X\);

  \(a_x\)~-- проекция вектора ускорения тела \(\vec{a}\) на ось \(X\).
\end{Underequation}

\begin{equation}\label{v_y_1}
  v_y(t) =
  \begin{cases}
    {v_0}_y + a_y t, & 0  \leqslant \Constrainttle, \\
    0,               & \Constrainttge.
  \end{cases}
\end{equation}

\begin{Underequation}
  \(v_y(t)\)~-- проекция вектора скорости тела \(\vec{v}(t)\) в момент времени \(t\) на ось \(Y\);

  \({v_0}_y\)~-- проекция вектора начальной скорости тела \(\vec{v_0}\) на ось \(Y\);

  \(a_y\)~-- проекция вектора ускорения тела \(\vec{a}\) на ось \(Y\).
\end{Underequation}

Теперь найдём формулу для траектории движения тела. Формуле, соответвующей (\ref{velocityvec_1}),
только для траектории, соответствует (\ref{traectoryvec_1}):

\begin{equation}\label{traectoryvec_1}
  \vec{r}(t) = \vec{r_0} + \vec{v_0}t + \frac{\vec{a}t^2}{2}
\end{equation}

\begin{Underequation}
  \(\vec{r}(t)\)~-- радиус-вектор положения тела в момент времени \(t\);

  \(\vec{r_0}\)~-- радиус-вектор начального положения тела.
\end{Underequation}

Исходя из (\ref{v_system}), уравнение для траектории с учётом того, что вектор скорости должен быть
противонаправлен вектору ускорения, будет (\ref{r_system_1}):

\begin{equation}\label{r_system_1}
  \vec{r}(t) = \begin{cases}
    \vec{r_0} + \vec{v_0}t + \frac{\vec{a}t^2}{2}, & 0 \leqslant \Constrainttle, \\
    \vec{r_0},                                     & \Constrainttge .
  \end{cases}
\end{equation}

Соответствующие проекции на ось абцисс (\ref{r_x_1}) и ординат (\ref{r_y_1}):

\begin{equation}\label{r_x_1}
  x(t) =
  \begin{cases}
    x_0 + {v_0}_x t + \frac{a_x t^2}{2}, & 0 \leqslant \Constrainttle, \\
    x_0,                                 & \Constrainttge.
  \end{cases}
\end{equation}

\begin{Underequation}
  \(x(t)\)~-- координата положения тела \(\vec{r}(t)\) в момент времени \(t\) на ось \(X\);

  \(x_0\)~-- координата начального положения тела \(\vec{v_0}\) на ось \(X\).
\end{Underequation}

\begin{equation}\label{r_y_1}
  y(t) =
  \begin{cases}
    y_0 + {v_0}_y t + \frac{a_y t^2}{2}, & 0 \leqslant \Constrainttle, \\
    y_0,                                 & \Constrainttge.
  \end{cases}
\end{equation}

\begin{Underequation}
  \(y(t)\)~-- координата положения тела \(\vec{r}(t)\) в момент времени \(t\) на ось \(Y\);

  \(y_0\)~-- координата начального положения тела \(\vec{v_0}\) на ось \(Y\).
\end{Underequation}

Формулы (\ref{r_x_1}) и (\ref{r_y_1}) являются ключевыми в этой работе.

\section{Определение уравнений для обнаружения столкновений}

Подставив формулы (\ref{r_x_1}) и (\ref{r_y_1}) в уравнения
(\ref{bodybodycollisioncoords}), (\ref{bodypointcollisioncoords}), (\ref{bodylinecolision})
можно получить алгебраические уравнения от \(t\) четвёртой степени.

Например, для случая, когда \(0 \leqslant \Constrainttle\) частичный вывод уравнения времени столкновения тела с телом будет таким (\ref{bodybodyoft}):

\begin{align}\label{bodybodyoft}
  \sqrt{(x_1(t) - x_2(t))^2 + (y_1(t) - y_2(t))^2}        & = r_1 + r_2 \nonumber     \\
  (x_1(t) - x_2(t))^2 + (y_1(t) - y_2(t))^2               & = (r_1 + r_2)^2 \nonumber \\
  ({x_0}_1 + {{v_0}_x}_1 t + \frac{{a_x}_1 t^2}{2})^2
  - ({x_0}_2 + {{v_0}_x}_2 t + \frac{{a_x}_2 t^2}{2})^2 + & \nonumber                 \\
  + ({y_0}_1 + {{v_0}_y}_1 t + \frac{{a_y}_1 t^2}{2})^2
  - ({y_0}_2 + {{v_0}_y}_2 t + \frac{{a_y}_2 t^2}{2})^2   & = (r_1 + r_2)^2
\end{align}

\begin{Underequation}
  \(x_1(t)\)~-- координата первого тела в момент времени \(t\) по оси \(X\);

  \(x_2(t)\)~-- координата второго тела в момент времени \(t\) по оси \(X\);

  \(y_1(t)\)~-- координата первого тела в момент времени \(t\) по оси \(Y\);

  \(y_2(t)\)~-- координата второго тела в момент времени \(t\) по оси \(Y\);

  \({x_0}_1\)~-- начальная координата первого тела по оси \(X\);

  \({x_0}_2\)~-- начальная координата второго тела по оси \(X\);

  \({y_0}_1\)~-- начальная координата первого тела по оси \(Y\);

  \({y_0}_2\)~-- начальная координата второго тела по оси \(Y\);

  \({{v_0}_x}_1\)~-- проекция вектора начальной скорости первого тела на ось \(X\);

  \({{v_0}_y}_1\)~-- проекция вектора начальной скорости первого тела на ось \(Y\);

  \({{v_0}_x}_2\)~-- проекция вектора начальной скорости второго тела на ось \(X\);

  \({{v_0}_y}_2\)~-- проекция вектора начальной скорости второго тела на ось \(Y\);

  \({a_x}_1\)~-- проекция вектора ускорения первого тела на ось \(X\);

  \({a_y}_1\)~-- проекция вектора ускорения первого тела на ось \(Y\);

  \({a_x}_2\)~-- проекция вектора ускорения второго тела на ось \(X\);

  \({a_y}_2\)~-- проекция вектора ускорения второго тела на ось \(Y\);

  \(r_1\)~-- радиус первого тела;

  \(r_2\)~-- радиус второго тела.
\end{Underequation}

Из (\ref{bodybodyoft}) видно, что дальнейшее раскрытие квадратов, сокращение, вынос \(t\) за скобки,
перенос из правой части в левую приведёт к тому, что уравнение примет вид (\ref{polyequation}).

\begin{equation}\label{polyequation}
  P(t) = 0
\end{equation}

\begin{Underequation}
  \(P(t)\)~-- многочлен от \(t\).
\end{Underequation}

Значит, уравнение алгебраическое одной переменной.
Теперь найдём степень уравнения (т.е. максимальную степень одночлена).
Возьмём одночлен \(\frac{{a_x}_1 t^2}{2}\), который является частью многочлена, который возведён в квадрат.
Следовательно, в результирующем многочлеле будет присутствовать одночлен (\ref{monomial_1}).

\begin{equation}\label{monomial_1}
  (\frac{{a_x}_1 t^2}{2})^2 = \frac{{a_x}_1^2 t^4}{4}
\end{equation}

Как видно, в результирующем многочлеле \(t\) возведён в 4 степень.
При этом в результирующем уравнении этот одночлен не сократится
потому что у других подобных одночленов другие коэффициенты.
Значит, в результирующем уравнении будет присутствовать одночлен степени 4.

Так как для каждого случая подстановки формул (\ref{r_x_1}) и (\ref{r_y_1}) в уравнения
(\ref{bodybodycollisioncoords}), (\ref{bodypointcollisioncoords}), (\ref{bodylinecolision})
придётся производить 8 таких выводов
(для каждого из 2 случев из (\ref{r_x_1}) следует рассмотреть 2 случая из (\ref{r_y_1}) при подстановке в (\ref{bodybodycollisioncoords})
и по 2 случая при подстановке в (\ref{bodypointcollisioncoords}) и (\ref{bodylinecolision})),
проще составить программный алгоритм (который описан позднее в \TODO),
который применяя методы компьютерной алгебры, сможет строить выражения и вычислять их значения, подставляя переменные.
